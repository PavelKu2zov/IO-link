//**************************************************************************************************
// @Module        DATA_LAYER
// @Filename      Data_layer.c
//--------------------------------------------------------------------------------------------------
// @Platform      PLATFORM_NAME
//--------------------------------------------------------------------------------------------------
// @Compatible    COMPATIBLE_PROCESSOR_MODULE
//--------------------------------------------------------------------------------------------------
// @Description   Implementation of the MODULE functionality.
//                [Description...]
//
//                Abbreviations:
//                  
//                  
//
//                Global (public) functions:
//                  DL_Init()
//                  DL_Read()
//                  DL_Write()
//                  DL_SetMode()
//                  DL_GetMode()
//
//                Local (private) functions:
//                  None.
//                  
//
//--------------------------------------------------------------------------------------------------
// @Version       1.0.0
//--------------------------------------------------------------------------------------------------
// @Date          XX.XX.XXXX
//--------------------------------------------------------------------------------------------------
// @History       Version  Author      Comment
// XX.XX.XXXX     1.0.0    XXX         First release.
//**************************************************************************************************



//**************************************************************************************************
// Project Includes
//**************************************************************************************************

// Native header

#include "IO_LINK.h"
#include "terminal.h"
#include "Data_layer.h"
#include "DL_ModeHandler.h"
#include "DL_MessageHandler.h"



//**************************************************************************************************
// Verification of the imported configuration parameters
//**************************************************************************************************

// None.



//**************************************************************************************************
// Definitions of global (public) variables
//**************************************************************************************************

// None.


//**************************************************************************************************
// Declarations of local (private) data types
//**************************************************************************************************

// None.



//**************************************************************************************************
// Definitions of local (private) constants
//**************************************************************************************************

// None.



//**************************************************************************************************
// Definitions of static global (private) variables
//**************************************************************************************************

// None.



//**************************************************************************************************
// Declarations of local (private) functions
//**************************************************************************************************

// None.



//**************************************************************************************************
//==================================================================================================
// Definitions of global (public) functions
//==================================================================================================
//**************************************************************************************************



//**************************************************************************************************
// @Function      DL_Init()
//--------------------------------------------------------------------------------------------------
// @Description   [description...]
//--------------------------------------------------------------------------------------------------
// @Notes
//--------------------------------------------------------------------------------------------------
// @ReturnValue   returnValue - [description...]
//--------------------------------------------------------------------------------------------------
// @Parameters    parameterZero - [description...]
//**************************************************************************************************
void DL_Init(void)
{   
    // Init DL_ModeHandler
    DL_MODE_Init();
        
    // Init DL_MessageHandler
    DL_MES_Init();
    
    // Init DL_OnRequestDataHnadler
    
    
    // Init DL_ProcessDataHandler
    
} // end of DL_Init()



//**************************************************************************************************
// @Function      DL_Read()
//--------------------------------------------------------------------------------------------------
// @Description   [description...]
//--------------------------------------------------------------------------------------------------
// @Notes
//--------------------------------------------------------------------------------------------------
// @ReturnValue   returnValue - [description...]
//--------------------------------------------------------------------------------------------------
// @Parameters    parameterZero - [description...]
//**************************************************************************************************
void DL_Read(const U8* addr, DL_MES_RESPONSE_TYPE *const response)
{
    // request DL_read
    DL_MES_Req_DL_Read(addr);
    
    // toggle task of MH
    DL_MES_Task();
    
    // get receive data and response
    *response = DL_MES_GetResponse_DL_Read_req();
    
} // end of DL_Read()



//**************************************************************************************************
// @Function      DL_Write()
//--------------------------------------------------------------------------------------------------
// @Description   [description...]
//--------------------------------------------------------------------------------------------------
// @Notes
//--------------------------------------------------------------------------------------------------
// @ReturnValue   returnValue - [description...]
//--------------------------------------------------------------------------------------------------
// @Parameters    parameterZero - [description...]
//                parameterOne  - [description...]
//**************************************************************************************************
void DL_Write(const U8* addr,const U8 *const data,DL_MES_RESPONSE_TYPE *const response)
{
    // requset Dl_write
    DL_MES_Req_DL_Write(addr,data);  
    
    // toggle task of MH
    DL_MES_Task();
	
	// get response data
    *response = DL_MES_GetResponse_DL_Read_req();
    
} // end of DL_Write()



//**************************************************************************************************
// @Function      DL_SetMode()
//--------------------------------------------------------------------------------------------------
// @Description   [description...]
//--------------------------------------------------------------------------------------------------
// @Notes
//--------------------------------------------------------------------------------------------------
// @ReturnValue   returnValue - [description...]
//--------------------------------------------------------------------------------------------------
// @Parameters    parameterZero - [description...]
//                parameterOne  - [description...]
//**************************************************************************************************
void DL_SetMode(const U8 mode)
{
	// change mode
	DL_MODE_ChangeMode(mode);

	// toggle task	
    DL_MODE_Task();
      
} // end of DL_SetMode()



//**************************************************************************************************
// @Function      DL_GetMode()
//--------------------------------------------------------------------------------------------------
// @Description   [description...]
//--------------------------------------------------------------------------------------------------
// @Notes
//--------------------------------------------------------------------------------------------------
// @ReturnValue   returnValue - [description...]
//--------------------------------------------------------------------------------------------------
// @Parameters    parameterZero - [description...]
//                parameterOne  - [description...]
//**************************************************************************************************
uint8_t DL_GetMode(void)
{
    U8 currentMode_DL = DL_MODE_GetCurrentMode();
    
    if (DL_INACTIVE == currentMode_DL)
    {
    #ifdef DEBUG
        TERMINAL_SendMessage( "DL_MODE -> DL_INACTIVE\r\n");
    #endif 
    }
    else if (DL_START_UP == currentMode_DL)
    {
    #ifdef DEBUG
        TERMINAL_SendMessage( "DL_MODE -> DL_START_UP\r\n");
    #endif 
    }
    else if (DL_PREOPERATE == currentMode_DL)
    {
    #ifdef DEBUG
        TERMINAL_SendMessage( "DL_MODE -> DL_PREOPERATE\r\n");
    #endif 
    }
    else if (DL_OPERATE == currentMode_DL) 
    {
    #ifdef DEBUG
        TERMINAL_SendMessage( "DL_MODE -> DL_OPERATE\r\n");
    #endif 
    }
  
  return currentMode_DL;
    
} // end of DL_GetMode()


//**************************************************************************************************
//==================================================================================================
// Definitions of local (private) functions
//==================================================================================================
//**************************************************************************************************

// None.



//****************************************** end of file *******************************************
